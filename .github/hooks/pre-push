#!/bin/bash
# Pre-push hook for nutrition-fact-labeller-rust
# This hook runs cargo fmt, cargo test, and cargo clippy before pushing

set -e

echo "Running pre-push checks..."

# Check formatting
echo "ğŸ” Checking code formatting with cargo fmt..."
if ! cargo fmt --check; then
  echo "âŒ Code formatting check failed!"
  echo "   Run 'cargo fmt' to fix formatting issues."
  exit 1
fi
echo "âœ… Code formatting check passed"

# Run tests
echo "ğŸ§ª Running tests with cargo test..."
if ! cargo test; then
  echo "âŒ Tests failed!"
  exit 1
fi
echo "âœ… Tests passed"

# Run linter
echo "ğŸ“‹ Running linter with cargo clippy..."
if ! cargo clippy -- -D warnings; then
  echo "âŒ Linting failed!"
  echo "   Run 'cargo clippy' to see and fix linting issues."
  exit 1
fi
echo "âœ… Linting passed"

echo "ğŸ‰ All pre-push checks passed!"
